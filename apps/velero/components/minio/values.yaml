---
apiVersion: builtin
kind: HelmChartInflationGenerator
metadata:
  name: velero-chart
valuesInline:
  # Init containers to add to the Velero deployment's pod spec. At least one plugin provider image is required.
  # If the value is a string then it is evaluated as a template.
  initContainers:
    - name: velero-plugin-for-aws
      # renovate: datasource=docker image=velero/velero-plugin-for-aws
      image: velero/velero-plugin-for-aws:v1.13.1
      imagePullPolicy: IfNotPresent
      volumeMounts:
        - mountPath: /target
          name: plugins
  configuration:
    # Parameters for the BackupStorageLocation(s). Configure multiple by adding other element(s) to the backupStorageLocation slice.
    # See https://velero.io/docs/v1.6/api-types/backupstoragelocation/
    backupStorageLocation:
      # name is the name of the backup storage location where backups should be stored. If a name is not provided,
      # a backup storage location will be created with the name "default". Optional.
    - name: default
      # provider is the name for the backup storage location provider.
      provider: aws
      # bucket is the name of the bucket to store backups in. Required.
      bucket: velero
      # caCert defines a base64 encoded CA bundle to use when verifying TLS connections to the provider. Optional.
      # caCert:
      # prefix is the directory under which all Velero data should be stored within the bucket. Optional.
      prefix: cluster
      # default indicates this location is the default backup storage location. Optional.
      default: true
      # validationFrequency defines how frequently Velero should validate the object storage. Optional.
      # validationFrequency:
      # accessMode determines if velero can write to this backup storage location. Optional.
      # default to ReadWrite, ReadOnly is used during migrations and restores.
      accessMode: ReadWrite
      credential:
        # name of the secret used by this backupStorageLocation.
        name: velero-credentials
        # name of key that contains the secret data to be used.
        key: cloud
      # Additional provider-specific configuration. See link above
      # for details of required/optional fields for your provider.
      config:
      #  region:
        s3ForcePathStyle: true
        s3Url: https://s3.k8s.example.com
      #  kmsKeyId:
      #  resourceGroup:
      #  The ID of the subscription containing the storage account, if different from the clusterâ€™s subscription. (Azure only)
      #  subscriptionId:
      #  storageAccount:
      #  publicUrl:
      #  Name of the GCP service account to use for this backup storage location. Specify the
      #  service account here if you want to use workload identity instead of providing the key file.(GCP only)
      #  serviceAccount:
      #  Option to skip certificate validation or not if insecureSkipTLSVerify is set to be true, the client side should set the
      #  flag. For Velero client Command like velero backup describe, velero backup logs needs to add the flag --insecure-skip-tls-verify
        insecureSkipTLSVerify: true

      # annotations allows adding arbitrary annotations to this BackupStorageLocation resource. Optional.
      annotations: {}
